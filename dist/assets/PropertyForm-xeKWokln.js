import{_ as I,r as d,l as F,z as U,p as u,c,b as t,j as h,t as b,e as k,f as y,v as g,F as N,n as V,d as S,w as A,h as B,A as C,i as D,o as v,g as M}from"./index-DYB-CqZx.js";const q={class:"container"},E={class:"card"},R={key:0,class:"error"},T={class:"form-group"},$={class:"form-group"},j={class:"form-group"},z={class:"form-group"},K={class:"form-group"},L={key:0,class:"image-preview-grid"},O=["src","alt"],G={class:"form-actions"},H=["disabled"],J={__name:"PropertyForm",setup(Q){const w=D(),_=U(),n=d(!1),m=d(null),r=d({title:"",description:"",address:"",price:0}),i=d([]),f=d(!1),p=d(""),P=async o=>{const e=Array.from(o.target.files);for(const s of e)try{const l=(await C.uploadFile(s)).data.url;i.value.push(l),n.value&&await u.addImage(m.value,l)}catch{alert(`Failed to upload ${s.name}`)}},x=async()=>{var o,e;f.value=!0,p.value="";try{let s;if(n.value)s=await u.update(m.value,r.value);else if(s=await u.create(r.value),i.value.length>0){const a=s.data.id;for(const l of i.value)await u.addImage(a,l)}w.push("/dashboard")}catch(s){p.value=((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.error)||"Failed to save property"}finally{f.value=!1}};return F(async()=>{if(_.params.id){n.value=!0,m.value=parseInt(_.params.id);try{const e=(await u.getOne(m.value)).data;r.value={title:e.title,description:e.description,address:e.address,price:e.price},i.value=e.images||[]}catch{p.value="Failed to load property"}}}),(o,e)=>{const s=B("router-link");return v(),c("div",q,[t("div",E,[t("h2",null,b(n.value?"Edit Property":"Add New Property"),1),p.value?(v(),c("div",R,b(p.value),1)):h("",!0),t("form",{onSubmit:k(x,["prevent"])},[t("div",T,[e[4]||(e[4]=t("label",{for:"title"},"Property Title *",-1)),y(t("input",{id:"title","onUpdate:modelValue":e[0]||(e[0]=a=>r.value.title=a),type:"text",placeholder:"Beautiful 2BR apartment in Nairobi",required:""},null,512),[[g,r.value.title]])]),t("div",$,[e[5]||(e[5]=t("label",{for:"description"},"Description",-1)),y(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=a=>r.value.description=a),placeholder:"Describe your property, amenities, and what makes it special..."},null,512),[[g,r.value.description]])]),t("div",j,[e[6]||(e[6]=t("label",{for:"address"},"Address *",-1)),y(t("input",{id:"address","onUpdate:modelValue":e[2]||(e[2]=a=>r.value.address=a),type:"text",placeholder:"123 Main St, Nairobi, Kenya",required:""},null,512),[[g,r.value.address]])]),t("div",z,[e[7]||(e[7]=t("label",{for:"price"},"Price per Night (USD) *",-1)),y(t("input",{id:"price","onUpdate:modelValue":e[3]||(e[3]=a=>r.value.price=a),type:"number",step:"0.01",min:"0",placeholder:"50.00",required:""},null,512),[[g,r.value.price,void 0,{number:!0}]])]),t("div",K,[e[8]||(e[8]=t("label",null,"Property Images",-1)),t("input",{type:"file",accept:"image/*",multiple:"",onChange:P},null,32),e[9]||(e[9]=t("p",{class:"help-text"},"Upload images of your property (max 5MB each)",-1)),i.value.length>0?(v(),c("div",L,[(v(!0),c(N,null,V(i.value,(a,l)=>(v(),c("div",{key:l,class:"image-preview"},[t("img",{src:a,alt:`Property image ${l+1}`},null,8,O)]))),128))])):h("",!0)]),t("div",G,[t("button",{type:"submit",class:"btn btn-primary",disabled:f.value},b(f.value?"Saving...":n.value?"Update Property":"Create Property"),9,H),S(s,{to:"/dashboard",class:"btn btn-secondary"},{default:A(()=>[...e[10]||(e[10]=[M("Cancel",-1)])]),_:1})])],32)])])}}},X=I(J,[["__scopeId","data-v-ebeb9d66"]]);export{X as default};
