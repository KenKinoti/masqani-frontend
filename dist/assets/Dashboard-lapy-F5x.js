import{_ as X,u as Y,k as C,r as h,l as tt,c as n,b as t,j as c,g as b,t as i,m as I,d as j,w as _,h as et,F as M,f as T,n as ot,p as A,q as P,e as st,v as at,s as nt,x as F,y as w,o as a,z as it}from"./index-5LYfcNcr.js";const rt={class:"dashboard"},lt={class:"hero-section"},dt={class:"hero-content"},ct={class:"hero-text"},ut={class:"hero-title"},vt={class:"text-gradient"},pt={class:"hero-subtitle"},ht={key:0,class:"hero-actions"},kt={class:"stats-section"},gt={class:"stats-grid"},mt={class:"stat-card"},_t={class:"stat-content"},wt={class:"stat-value"},yt={key:0,class:"stat-change positive"},ft={class:"stat-card"},bt={class:"stat-content"},Mt={class:"stat-value"},Bt={key:0,class:"stat-change positive"},xt={key:0,class:"stat-card"},Ct={class:"stat-content"},jt={class:"stat-value"},At={key:1,class:"stat-card"},Pt={class:"stat-content"},St={class:"stat-value"},Rt={key:0,class:"stat-change neutral"},zt={class:"stat-card"},Vt={class:"stat-content"},Dt={class:"stat-value"},Ft={key:0,class:"stat-change positive"},Lt={class:"revenue-section"},$t={class:"section-header"},Nt={class:"revenue-chart"},It={key:0,class:"no-data"},Tt={key:1,class:"chart-container"},Ht={class:"bar-wrapper"},Gt=["title"],Ut={class:"bar-label"},Wt={class:"bar-info"},Et={class:"week-label"},qt={class:"date-range"},Qt={class:"geographical-section"},Zt={class:"section-header"},Jt={class:"view-toggle"},Kt={class:"geo-grid"},Ot={class:"geo-header"},Xt={class:"geo-name"},Yt={class:"geo-badge"},te={class:"geo-stats"},ee={class:"geo-stat"},oe={class:"stat-value"},se={class:"geo-stat"},ae={class:"stat-value"},ne={class:"geo-stat"},ie={class:"stat-value"},re={class:"geo-trend"},le={key:0,class:"trend-icon up",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},de={key:1,class:"trend-icon down",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ce={class:"pending-section"},ue={key:0,class:"no-pending"},ve={key:1,class:"pending-list"},pe={class:"pending-info"},he={class:"property-title"},ke={class:"property-location"},ge={class:"property-host"},me={class:"pending-actions"},_e=["onClick"],we=["onClick"],ye={class:"modal-content"},fe={class:"modal-subtitle"},be={class:"modal-actions"},Me=["disabled"],Be={key:1,class:"actions-section"},xe={class:"actions-grid"},Ce={key:2,class:"activity-section"},je={class:"activity-list"},Ae={fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pe={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"},Se={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"},Re={key:2,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},ze={class:"activity-content"},Ve={class:"activity-text"},De={class:"activity-time"},Fe={__name:"Dashboard",setup(Le){const L=Y(),g="https://masqani-api-ug5fk2kuxq-uc.a.run.app",H=C(()=>{var e;return(((e=L.user)==null?void 0:e.full_name)||"Guest").split(" ")[0]}),d=C(()=>{var o;return((o=L.user)==null?void 0:o.role)||"guest"}),G=C(()=>d.value==="admin"?"Manage your platform from one place":d.value==="host"?"Track your properties and bookings":"Find your perfect stay"),r=h({properties:0,bookings:0,views:0,revenue:0,newThisMonth:0,newBookings:0,revenueGrowth:0}),m=h(!0),S=h([]),$=h({}),k=h([]),y=h([]),B=h([]),R=h("8"),f=h("region"),p=h({show:!1,property:null,reason:""}),U=C(()=>!y.value||y.value.length===0?[]:y.value.filter(o=>f.value==="region"?o.type==="region":o.type==="suburb")),x=(o,e=!1)=>{if(!o)return"0";const l=parseFloat(o);return e&&l>=1e3?(l/1e3).toFixed(1)+"k":l.toLocaleString("en-ZA",{minimumFractionDigits:0,maximumFractionDigits:0})},W=(o,e)=>{if(!o||!e)return"";const l=new Date(o),u=new Date(e),s={month:"short",day:"numeric"},v=l.toLocaleDateString("en-US",s),O=u.toLocaleDateString("en-US",s);return v+" - "+O},E=o=>{if(!k.value||k.value.length===0)return 0;const e=Math.max(...k.value.map(l=>l.totalRevenue));return e>0?o/e*100:0},q=async()=>{var o,e;try{m.value=!0;const l=await nt.getAll();r.value.properties=((o=l.data)==null?void 0:o.length)||0,r.value.newThisMonth=Math.floor(r.value.properties*.15);let u;d.value==="admin"?u=await F.getAllBookings():d.value==="host"?u=await F.getHostBookings():u=await F.getUserBookings(),r.value.bookings=((e=u.data)==null?void 0:e.length)||0,r.value.newBookings=Math.floor(r.value.bookings*.3),r.value.views=r.value.properties*127+Math.floor(Math.random()*100),r.value.revenue=r.value.bookings*350+Math.floor(Math.random()*1e3),r.value.revenueGrowth=Math.floor(Math.random()*25)+5,u.data&&u.data.length>0&&d.value!=="admin"&&(S.value=u.data.slice(0,5).map((s,v)=>({type:"booking",text:`New booking for ${s.property_title||"Property"}`,time:`${v+1} ${v===0?"hour":"hours"} ago`})))}catch(l){console.error("Failed to fetch stats:",l)}finally{m.value=!1}},z=async()=>{try{const o=localStorage.getItem("token"),e=await w.get(g+"/api/admin/dashboard/metrics",{headers:{Authorization:"Bearer "+o}});$.value=e.data}catch(o){console.error("Failed to load admin metrics:",o)}},N=async()=>{try{const o=localStorage.getItem("token"),e=await w.get(g+"/api/admin/dashboard/revenue?weeks="+R.value,{headers:{Authorization:"Bearer "+o}});k.value=e.data||[]}catch(o){console.error("Failed to load revenue data:",o),k.value=[]}},Q=async()=>{try{const o=localStorage.getItem("token"),e=await w.get(g+"/api/admin/dashboard/geographical",{headers:{Authorization:"Bearer "+o}});y.value=e.data||[]}catch(o){console.error("Failed to load geographical data:",o),y.value=[]}},V=async()=>{try{const o=localStorage.getItem("token"),e=await w.get(g+"/api/admin/properties/pending",{headers:{Authorization:"Bearer "+o}});B.value=e.data||[]}catch(o){console.error("Failed to load pending properties:",o),B.value=[]}},Z=async o=>{try{const e=localStorage.getItem("token");await w.put(g+"/api/admin/properties/"+o+"/approve",{},{headers:{Authorization:"Bearer "+e}}),await V(),await z()}catch(e){console.error("Failed to approve property:",e),alert("Failed to approve property")}},J=o=>{p.value={show:!0,property:o,reason:""}},D=()=>{p.value={show:!1,property:null,reason:""}},K=async()=>{if(p.value.reason)try{const o=localStorage.getItem("token");await w.put(g+"/api/admin/properties/"+p.value.property.id+"/reject",{reason:p.value.reason},{headers:{Authorization:"Bearer "+o}}),await V(),await z(),D()}catch(o){console.error("Failed to reject property:",o),alert("Failed to reject property")}};return tt(async()=>{await q(),d.value==="admin"&&await Promise.all([z(),N(),Q(),V()])}),(o,e)=>{var u;const l=et("router-link");return a(),n("div",rt,[t("section",lt,[t("div",dt,[t("div",ct,[t("h1",ut,[e[4]||(e[4]=b(" Welcome back, ",-1)),t("span",vt,i(H.value),1)]),t("p",pt,i(G.value),1)]),d.value!=="admin"?(a(),n("div",ht,[d.value!=="guest"?(a(),I(l,{key:0,to:"/properties/new",class:"btn-hero btn-primary"},{default:_(()=>[...e[5]||(e[5]=[t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),b(" Add New Property ",-1)])]),_:1})):c("",!0),j(l,{to:"/properties",class:"btn-hero btn-secondary"},{default:_(()=>[...e[6]||(e[6]=[t("svg",{class:"icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),b(" Browse Properties ",-1)])]),_:1})])):c("",!0)]),e[7]||(e[7]=t("div",{class:"hero-decoration"},[t("div",{class:"decoration-circle circle-1"}),t("div",{class:"decoration-circle circle-2"}),t("div",{class:"decoration-circle circle-3"})],-1))]),t("section",kt,[t("div",gt,[t("div",mt,[e[9]||(e[9]=t("div",{class:"stat-icon stat-icon-blue"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})])],-1)),t("div",_t,[e[8]||(e[8]=t("p",{class:"stat-label"},"Total Properties",-1)),t("p",wt,i(r.value.properties),1),m.value?c("",!0):(a(),n("p",yt,"+"+i(r.value.newThisMonth)+" this month",1))])]),t("div",ft,[e[11]||(e[11]=t("div",{class:"stat-icon stat-icon-green"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),t("div",bt,[e[10]||(e[10]=t("p",{class:"stat-label"},"Active Bookings",-1)),t("p",Mt,i(r.value.bookings),1),m.value?c("",!0):(a(),n("p",Bt,"+"+i(r.value.newBookings)+" new",1))])]),d.value==="admin"?(a(),n("div",xt,[e[14]||(e[14]=t("div",{class:"stat-icon stat-icon-warning"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",Ct,[e[12]||(e[12]=t("p",{class:"stat-label"},"Pending Listings",-1)),t("p",jt,i($.value.pendingListings||0),1),e[13]||(e[13]=t("p",{class:"stat-change neutral"},"Awaiting approval",-1))])])):c("",!0),d.value!=="admin"?(a(),n("div",At,[e[16]||(e[16]=t("div",{class:"stat-icon stat-icon-purple"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})])],-1)),t("div",Pt,[e[15]||(e[15]=t("p",{class:"stat-label"},"Total Views",-1)),t("p",St,i(r.value.views),1),m.value?c("",!0):(a(),n("p",Rt,"This week"))])])):c("",!0),t("div",zt,[e[18]||(e[18]=t("div",{class:"stat-icon stat-icon-gold"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",Vt,[e[17]||(e[17]=t("p",{class:"stat-label"},"Revenue",-1)),t("p",Dt,"A$"+i(r.value.revenue.toLocaleString()),1),m.value?c("",!0):(a(),n("p",Ft,"+"+i(r.value.revenueGrowth)+"% growth",1))])])])]),d.value==="admin"?(a(),n(M,{key:0},[t("section",Lt,[t("div",$t,[e[20]||(e[20]=t("h2",{class:"section-title"},"Revenue per Week",-1)),T(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>R.value=s),onChange:N,class:"filter-select"},[...e[19]||(e[19]=[t("option",{value:"4"},"Last 4 Weeks",-1),t("option",{value:"8"},"Last 8 Weeks",-1),t("option",{value:"12"},"Last 12 Weeks",-1)])],544),[[ot,R.value]])]),t("div",Nt,[k.value.length===0?(a(),n("div",It,[...e[21]||(e[21]=[t("p",null,"No revenue data available",-1)])])):(a(),n("div",Tt,[(a(!0),n(M,null,A(k.value,(s,v)=>(a(),n("div",{key:v,class:"bar-group"},[t("div",Ht,[t("div",{class:"bar",style:it({height:E(s.totalRevenue)+"%"}),title:"A$"+x(s.totalRevenue)},[t("span",Ut,"A$"+i(x(s.totalRevenue,!0)),1)],12,Gt)]),t("div",Wt,[t("p",Et,"Week "+i(v+1),1),t("p",qt,i(W(s.weekStart,s.weekEnd)),1)])]))),128))]))])]),t("section",Qt,[t("div",Zt,[e[22]||(e[22]=t("h2",{class:"section-title"},"Geographical Performance",-1)),t("div",Jt,[t("button",{onClick:e[1]||(e[1]=s=>f.value="region"),class:P([{active:f.value==="region"},"toggle-btn"])}," By Region ",2),t("button",{onClick:e[2]||(e[2]=s=>f.value="suburb"),class:P([{active:f.value==="suburb"},"toggle-btn"])}," By Suburb ",2)])]),t("div",Kt,[(a(!0),n(M,null,A(U.value,s=>(a(),n("div",{key:s.name,class:"geo-card"},[t("div",Ot,[t("h3",Xt,i(s.name),1),t("span",Yt,i(s.propertyCount)+" properties",1)]),t("div",te,[t("div",ee,[e[23]||(e[23]=t("span",{class:"stat-label"},"Bookings",-1)),t("span",oe,i(s.bookingCount),1)]),t("div",se,[e[24]||(e[24]=t("span",{class:"stat-label"},"Revenue",-1)),t("span",ae,"A$"+i(x(s.totalRevenue)),1)]),t("div",ne,[e[25]||(e[25]=t("span",{class:"stat-label"},"Avg. Price",-1)),t("span",ie,"A$"+i(x(s.avgPrice)),1)])]),t("div",re,[s.trend>0?(a(),n("svg",le,[...e[26]||(e[26]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)])])):(a(),n("svg",de,[...e[27]||(e[27]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"},null,-1)])])),t("span",{class:P(s.trend>0?"trend-up":"trend-down")},i(Math.abs(s.trend))+"% "+i(s.trend>0?"growth":"decline"),3)])]))),128))])]),t("section",ce,[e[31]||(e[31]=t("h2",{class:"section-title"},"Pending Property Approvals",-1)),B.value.length===0?(a(),n("div",ue,[...e[28]||(e[28]=[t("svg",{class:"no-pending-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("p",{class:"no-pending-text"},"All properties have been reviewed!",-1),t("p",{class:"no-pending-subtext"},"No pending approvals at this time.",-1)])])):(a(),n("div",ve,[(a(!0),n(M,null,A(B.value,s=>(a(),n("div",{key:s.id,class:"pending-card"},[t("div",pe,[t("h3",he,i(s.title),1),t("p",ke,i(s.suburb)+", "+i(s.region),1),t("p",ge,"Host: "+i(s.hostName),1)]),t("div",me,[t("button",{onClick:v=>Z(s.id),class:"btn-approve"},[...e[29]||(e[29]=[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),b(" Approve ",-1)])],8,_e),t("button",{onClick:v=>J(s),class:"btn-reject"},[...e[30]||(e[30]=[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),b(" Reject ",-1)])],8,we)])]))),128))]))]),p.value.show?(a(),n("div",{key:0,class:"modal-overlay",onClick:st(D,["self"])},[t("div",ye,[e[32]||(e[32]=t("h3",{class:"modal-title"},"Reject Property",-1)),t("p",fe,i((u=p.value.property)==null?void 0:u.title),1),T(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>p.value.reason=s),placeholder:"Enter reason for rejection...",class:"modal-textarea",rows:"4"},null,512),[[at,p.value.reason]]),t("div",be,[t("button",{onClick:D,class:"btn-cancel"},"Cancel"),t("button",{onClick:K,class:"btn-confirm-reject",disabled:!p.value.reason}," Reject Property ",8,Me)])])])):c("",!0)],64)):c("",!0),d.value!=="admin"?(a(),n("section",Be,[e[37]||(e[37]=t("h2",{class:"section-title"},"Quick Actions",-1)),t("div",xe,[j(l,{to:"/properties",class:"action-card"},{default:_(()=>[...e[33]||(e[33]=[t("div",{class:"action-icon"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})])],-1),t("h3",{class:"action-title"},"Browse Properties",-1),t("p",{class:"action-desc"},"Explore available properties and book your next stay",-1),t("div",{class:"action-arrow"},"→",-1)])]),_:1}),j(l,{to:"/bookings",class:"action-card"},{default:_(()=>[...e[34]||(e[34]=[t("div",{class:"action-icon"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1),t("h3",{class:"action-title"},"My Bookings",-1),t("p",{class:"action-desc"},"View and manage your current and past bookings",-1),t("div",{class:"action-arrow"},"→",-1)])]),_:1}),d.value!=="guest"?(a(),I(l,{key:0,to:"/properties/new",class:"action-card"},{default:_(()=>[...e[35]||(e[35]=[t("div",{class:"action-icon"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})])],-1),t("h3",{class:"action-title"},"Add Property",-1),t("p",{class:"action-desc"},"List a new property and start earning",-1),t("div",{class:"action-arrow"},"→",-1)])]),_:1})):c("",!0),j(l,{to:"/profile",class:"action-card"},{default:_(()=>[...e[36]||(e[36]=[t("div",{class:"action-icon"},[t("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1),t("h3",{class:"action-title"},"My Profile",-1),t("p",{class:"action-desc"},"Update your account settings and preferences",-1),t("div",{class:"action-arrow"},"→",-1)])]),_:1})])])):c("",!0),S.value.length>0&&d.value!=="admin"?(a(),n("section",Ce,[e[38]||(e[38]=t("h2",{class:"section-title"},"Recent Activity",-1)),t("div",je,[(a(!0),n(M,null,A(S.value,(s,v)=>(a(),n("div",{key:v,class:"activity-item"},[t("div",{class:P(["activity-icon",`activity-${s.type}`])},[(a(),n("svg",Ae,[s.type==="booking"?(a(),n("path",Pe)):s.type==="property"?(a(),n("path",Se)):(a(),n("path",Re))]))],2),t("div",ze,[t("p",Ve,i(s.text),1),t("p",De,i(s.time),1)])]))),128))])])):c("",!0)])}}},Ne=X(Fe,[["__scopeId","data-v-06fc623d"]]);export{Ne as default};
